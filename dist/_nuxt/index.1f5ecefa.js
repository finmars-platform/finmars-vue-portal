import{R as xe,r as V,S as Ce,U as ce,v as me,u as e,V as Ve,a as E,o as r,f as k,F as z,y as Q,i as pe,t as D,c as h,w as u,k as _,h as a,L as ee,m as b,x as I,z as O,W as ie,e as G,l as g,X as Be,H as re,b as te,p as ae,I as De,E as le,M as Fe,j as F,O as Pe,d as Ie,_ as Ue,Y as X,P as fe,q as ve,s as be,G as _e,Z as Se}from"./entry.e001551d.js";import{_ as q}from"./Icon.02350196.js";import{_ as K}from"./Input.5f2d228f.js";import{u as N}from"./useNotify.ee45f36b.js";import{_ as ye}from"./Menu.c4bdadcb.js";import{_ as ke}from"./TopRefresh.9a62cc06.js";import{_ as se}from"./Card.b3aab90e.js";import{_ as Ae}from"./Area.951d43e8.js";import{_ as Re}from"./Checkbox.a095e9fa.js";const Te=()=>null;function oe(...c){var y,f,d,M,B,v,S,A;const p=typeof c[c.length-1]=="string"?c.pop():void 0;typeof c[0]!="string"&&c.unshift(p);let[s,n,t={}]=c;if(typeof s!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof n!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(y=t.server)!=null?y:!0,t.default=(f=t.default)!=null?f:Te,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(M=(d=t.lazy)!=null?d:t.defer)!=null?M:!1,t.initialCache=(B=t.initialCache)!=null?B:!0;const l=xe(),m=()=>(l.isHydrating||t.initialCache)&&l.payload.data[s]!==void 0;l._asyncData[s]||(l._asyncData[s]={data:V(m()?l.payload.data[s]:(S=(v=t.default)==null?void 0:v.call(t))!=null?S:null),pending:V(!m()),error:V((A=l.payload._errors[s])!=null?A:null)});const o={...l._asyncData[s]};o.refresh=(T={})=>l._asyncDataPromises[s]?l._asyncDataPromises[s]:T._initial&&m()?l.payload.data[s]:(o.pending.value=!0,l._asyncDataPromises[s]=new Promise((R,P)=>{try{R(n(l))}catch(j){P(j)}}).then(R=>{t.transform&&(R=t.transform(R)),t.pick&&(R=Me(R,t.pick)),o.data.value=R,o.error.value=null}).catch(R=>{var P,j;o.error.value=R,o.data.value=e((j=(P=t.default)==null?void 0:P.call(t))!=null?j:null)}).finally(()=>{o.pending.value=!1,l.payload.data[s]=o.data.value,o.error.value&&(l.payload._errors[s]=!0),delete l._asyncDataPromises[s]}),l._asyncDataPromises[s]);const i=()=>o.refresh({_initial:!0}),$=t.server!==!1&&l.payload.serverRendered;{const T=Ve();if(T&&!T._nuxtOnBeforeMountCbs){T._nuxtOnBeforeMountCbs=[];const P=T._nuxtOnBeforeMountCbs;T&&(Ce(()=>{P.forEach(j=>{j()}),P.splice(0,P.length)}),ce(()=>P.splice(0,P.length)))}$&&l.isHydrating&&s in l.payload.data?o.pending.value=!1:T&&(l.payload.serverRendered&&l.isHydrating||t.lazy)?T._nuxtOnBeforeMountCbs.push(i):i(),t.watch&&me(t.watch,()=>o.refresh());const R=l.hook("app:data:refresh",P=>{if(!P||P.includes(s))return o.refresh()});T&&ce(R)}const x=Promise.resolve(l._asyncDataPromises[s]).then(()=>o);return Object.assign(x,o),x}function fo(...c){const p=typeof c[c.length-1]=="string"?c.pop():void 0;typeof c[0]!="string"&&c.unshift(p);const[s,n,t]=c;return oe(s,n,{...t,lazy:!0},null)}function Me(c,p){const s={};for(const n of p)s[n]=c[n];return s}const je={class:"fm_tabs"},Ee=["onClick"],Le={__name:"Tabs",props:{modelValue:String,tabs:Array},emits:["update:modelValue"],setup(c){return(p,s)=>(r(),k("div",je,[(r(!0),k(z,null,Q(c.tabs,(n,t)=>(r(),k("div",{class:pe(["fm_tabs_item",{active:n==c.modelValue}]),key:t,onClick:l=>p.$emit("update:modelValue",n)},D(n),11,Ee))),128))]))}},ze=E(Le,[["__scopeId","data-v-852cb3c3"]]),Ne={class:"selected"},Oe={__name:"File",props:{label:String},setup(c){let p=V("...");function s(n){let t=n.target.files[0];if(!t)return!1;p.value=t.name.length>20?t.name.slice(0,25)+"...":t.name}return(n,t)=>{const l=q,m=K;return r(),h(m,{class:"file_input",label:c.label,modelValue:" "},{button:u(()=>[_(l,{icon:"file_upload",type:"outlined"})]),sedeItems:u(()=>[]),default:u(()=>[a("input",{type:"file",onChange:s},null,32),a("div",Ne,D(e(p)),1)]),_:1},8,["label"])}}},Ye=E(Oe,[["__scopeId","data-v-ed1b276d"]]),He={class:"flex sb"},We=b("cancel"),qe=b("create"),Ke={__name:"DatabaseFromBackup",emits:["cancel"],setup(c,{emit:p}){let s=ee({}),n=V(!1);function t(){p("cancel"),n.value=!1}async function l(){if(n.value)return!1;let o=new FormData;for(let $ in s)o.append($,s[$]);n.value=!0,await I("masterCreateFrom.post",{body:o})&&N({type:"success",title:"Ecosystem is proccessing"}),t()}function m(o){s.file=o.target.files[0]}return(o,i)=>{const $=K,x=Ye,y=O,f=ie;return r(),h(f,{title:"Create Database",onCancel:i[4]||(i[4]=d=>t())},{controls:u(()=>[a("div",He,[_(y,{type:"text",onClick:i[2]||(i[2]=d=>t())},{default:u(()=>[We]),_:1}),_(y,{loading:e(n),onClick:i[3]||(i[3]=d=>l())},{default:u(()=>[qe]),_:1},8,["loading"])])]),default:u(()=>[_($,{label:"Name",modelValue:e(s).name,"onUpdate:modelValue":i[0]||(i[0]=d=>e(s).name=d)},null,8,["modelValue"]),_($,{label:"License key",modelValue:e(s).license_key,"onUpdate:modelValue":i[1]||(i[1]=d=>e(s).license_key=d)},null,8,["modelValue"]),_(x,{label:"Select file",onChange:m})]),_:1})}}},Ge=b(" You have been invited to \u201C "),Qe=b(" \u201D database by "),Xe=b("decline"),Ze=b("Accept"),Je={__name:"InviteItem",props:{invite:Object},emits:["refresh"],setup(c,{emit:p}){const s=c;async function n(t){(await I("invitesToDB.put",{body:{...s.invite,status:t},params:{id:s.invite.id}})).status&&p("refresh")}return(t,l)=>{const m=G("v-card-text"),o=O,i=se;return r(),h(i,{class:"d-flex flex-column",title:c.invite.to_master_user_object.name},{controls:u(()=>[_(o,{type:"text",onClick:l[0]||(l[0]=$=>n(2))},{default:u(()=>[Xe]),_:1}),_(o,{onClick:l[1]||(l[1]=$=>n(1))},{default:u(()=>[Ze]),_:1})]),default:u(()=>[c.invite.to_master_user_object.description?(r(),h(m,{key:0},{default:u(()=>[b(D(c.invite.to_master_user_object.description),1)]),_:1})):g("",!0),_(m,null,{default:u(()=>[Ge,a("b",null,D(c.invite.to_master_user_object.name),1),Qe,a("b",null,D(c.invite.from_user_object.username),1)]),_:1})]),_:1},8,["title"])}}},et=E(Je,[["__scopeId","data-v-862c8cbf"]]);function ne(c){return new Promise((p,s)=>{let n=Be("confirmSettings","$FkGfw6Pomx");n.value.text=c.text,n.value.isOpen=!0,me(n.value,()=>{n.value.result?p(!0):p(!1)})})}const tt=Ie(()=>Ue(()=>import("./WorkspaceRollbackM.5665415f.js"),["WorkspaceRollbackM.5665415f.js","WorkspaceRollbackM.3b794790.css","Loader.41d82123.js","entry.e001551d.js","entry.869cdbc9.css","Checkbox.a095e9fa.js","Icon.02350196.js","useNotify.ee45f36b.js","Input.5f2d228f.js","Menu.c4bdadcb.js","TopRefresh.9a62cc06.js","HorizontalPanel.b65b1a2f.js","Card.b3aab90e.js","Area.951d43e8.js"],import.meta.url)),st={class:"flex aic sb"},ot={class:"fm_card_title edit_hover m-b-0"},nt={key:0},at={class:"fm_list"},lt=["onClick"],it=b(" Restart "),rt=["onClick"],ct=b(" Rollback "),_t=["onClick"],ut=b(" Export backup "),dt=["onClick"],mt=b(" Delete "),pt=["onClick"],ft=b(" Exit "),vt={class:"fm_card_subtitle m-t-8"},bt={class:"fm_card_content fm_card_text mb-x edit_hover"},yt=b(" Add Description "),kt={class:"flex sb aic"},$t={class:"fm_card_text"},ht={class:"clipboard_text"},gt=b("open"),wt=b("cancel"),xt=b("save"),Ct={__name:"DatabasesItem",props:{db:Object},emits:["refresh","delete"],setup(c,{emit:p}){const s=c,n=re();let t=te(),l=V(!1),m=V(!1),o=V(!1),i=V(!1),$=V(null),x=V(null),y=ee({description:"",name:"",id:""});B(),V(!1);let f=ae(s.db.license_expiry_date),d=f.diff(ae(),"days"),M=De(()=>s.db.is_initialized?d<=0?`Expired ${f.format("DD.MM.YYYY")}`:d<=30?`Expire ${f.fromNow()}`:`Expire date: ${f.format("DD.MM.YYYY")}`:"Workspace is initializing");function B(){y.description=s.db.description,y.name=s.db.name,y.id=s.db.id}async function v(){await navigator.clipboard.writeText(`${n.public.apiURL}/${s.db.base_api_url}/api/v1/`),N({type:"success",title:"Copied to clipboard"})}function S(W){W=="title"?m.value=!0:l.value=!0,o.value=!0,setTimeout(()=>{$.value.focus()},0)}function A(){m.value=!1,l.value=!1,o.value=!1,s.db.name=s.db.name}async function T(){if(!await ne({text:"Are you sure?"}))return!1;let w=await I("masterExport.get",{params:{id:s.db.id}});w&&N({type:"success",title:w.message})}async function R(){if(!await ne({text:"Are you sure?"}))return!1;await I("masterRedeploy.get")&&(N({type:"success",title:"Success"}),p("refresh"))}async function P(){if(!await ne({text:"Are you sure?"}))return!1;let w=s.db.is_owner?await I("masterDelete.delete",{params:{id:s.db.id}}):await I("masterLeave.get",{params:{id:s.db.id}});w&&(t.getMasterUsers(),N({type:"success",title:w.message}))}async function j(){(await I("masterSet.patch",{body:{},params:{id:s.db.id}})).success&&(await t.ping(),Pe("/"))}async function C(){(await I("masterUser.put",{body:y,params:{id:y.id}})).status&&p("refresh"),A()}return(W,w)=>{const L=q,$e=ye,Z=O,he=Ae,ge=tt,we=se;return r(),h(we,{class:pe(["db",{red:e(d)<=0,warn:e(d)>0&&e(d)<=30}]),controls:""},{controls:u(()=>[a("div",kt,[a("div",null,[a("div",$t,"Role: "+D(c.db.is_owner?"owner":"admin"),1),a("div",{class:"clipboard flex aic",onClick:w[5]||(w[5]=U=>v())},[a("div",ht,D(c.db.base_api_url),1),_(L,{class:"m-l-4",icon:"content_copy",size:"16"})])]),!e(o)&&c.db.is_initialized?(r(),k(z,{key:0},[e(o)?g("",!0):(r(),h(Z,{key:0,onClick:w[6]||(w[6]=U=>j())},{default:u(()=>[gt]),_:1}))],64)):g("",!0),e(o)?(r(),k(z,{key:1},[_(Z,{type:"text",onClick:w[7]||(w[7]=U=>A())},{default:u(()=>[wt]),_:1}),_(Z,{onClick:w[8]||(w[8]=U=>C())},{default:u(()=>[xt]),_:1})],64)):g("",!0)])]),default:u(()=>[a("div",st,[a("div",ot,[e(m)?g("",!0):(r(),k("span",nt,D(e(m)?e(y).name:c.db.name),1)),e(m)?g("",!0):(r(),h(L,{key:1,primary:"",class:"edit_icon",icon:"edit",onClick:w[0]||(w[0]=U=>S("title"))})),e(m)?le((r(),k("input",{key:2,class:"fm_card_title m-b-0","onUpdate:modelValue":w[1]||(w[1]=U=>e(y).name=U),ref_key:"title",ref:$},null,512)),[[Fe,e(y).name]]):g("",!0)]),c.db.is_owner||c.db.is_admin?(r(),h($e,{key:0,anchor:"right"},{btn:u(()=>[_(L,{icon:"settings"})]),default:u(({close:U})=>[a("div",at,[a("div",{class:"fm_list_item",onClick:J=>(R(),U())},[_(L,{class:"mr-10",icon:"restart_alt"}),it],8,lt),a("div",{class:"fm_list_item",onClick:J=>(F(i)?i.value=!0:i=!0,U())},[_(L,{class:"mr-10",icon:"cloud_sync"}),ct],8,rt),a("div",{class:"fm_list_item",onClick:J=>(T(),U())},[_(L,{class:"mr-10",icon:"cloud_upload"}),ut],8,_t),c.db.is_owner?(r(),k("div",{key:0,class:"fm_list_item",onClick:J=>(P(),U())},[_(L,{class:"mr-10",icon:"delete"}),mt],8,dt)):(r(),k("div",{key:1,class:"fm_list_item",onClick:J=>(P(),U())},[_(L,{class:"mr-10",icon:"exit_to_app"}),ft],8,pt))])]),_:1})):g("",!0)]),a("div",vt,D(e(M)),1),a("div",bt,[e(l)?(r(),h(he,{key:1,modelValue:e(y).description,"onUpdate:modelValue":w[4]||(w[4]=U=>e(y).description=U),ref_key:"description",ref:x},null,8,["modelValue"])):(r(),k(z,{key:0},[b(D(e(l)?e(y).description:c.db.description)+" ",1),c.db.description?(r(),h(L,{key:0,primary:"",class:"edit_icon",icon:"edit",onClick:w[2]||(w[2]=U=>S())})):(r(),h(Z,{key:1,class:"plain text-capitalize",type:"action",onClick:w[3]||(w[3]=U=>S())},{default:u(()=>[yt]),_:1}))],64))]),e(i)?(r(),h(ge,{key:0,workspaceId:c.db.id,modelValue:e(i),"onUpdate:modelValue":w[9]||(w[9]=U=>F(i)?i.value=U:i=U)},null,8,["workspaceId","modelValue"])):g("",!0)]),_:1},8,["class"])}}},Vt=E(Ct,[["__scopeId","data-v-9cb42e38"]]),Bt={class:"fm_list"},Dt=b(" New "),Ft=b(" From Backup "),Pt={key:0,class:"fm_container databases p-b-16"},It={key:1,class:"fm_container databases"},Ut={key:2,class:"fm_container databases"},St={__name:"Databases",async setup(c){let p,s,n=te(),{data:t,refresh:l}=([p,s]=X(()=>oe("invitesToDB",()=>I("invitesToDB.get"),{lazy:!0},"$P4aThzqidk")),p=await p,s(),p),m=V(!1);return(o,i)=>{const $=q,x=fe,y=Ke,f=ye,d=ke,M=et,B=Vt;return r(),k("div",null,[_(d,{onRefresh:i[3]||(i[3]=v=>(e(n).getMasterUsers(),e(l)()))},{action:u(()=>[_(f,null,{btn:u(()=>[_($,{btnPrimary:"",icon:"add"})]),default:u(()=>[a("div",Bt,[_(x,{class:"fm_list_item",to:"/profile/add-database"},{default:u(()=>[Dt]),_:1}),a("div",{class:"fm_list_item",onClick:i[2]||(i[2]=v=>F(m)?m.value=!0:m=!0)},[Ft,_(y,{modelValue:e(m),"onUpdate:modelValue":i[0]||(i[0]=v=>F(m)?m.value=v:m=v),onCancel:i[1]||(i[1]=v=>(F(m)?m.value=!1:m=!1,e(n).getMasterUsers()))},null,8,["modelValue"])])])]),_:1})]),_:1}),e(t)&&e(t).results.length?(r(),k("div",Pt,[(r(!0),k(z,null,Q(e(t).results,v=>(r(),h(M,{invite:v,key:v.id,onRefresh:i[4]||(i[4]=S=>(e(n).getMasterUsers(),e(l)()))},null,8,["invite"]))),128))])):g("",!0),e(n).masterUsers.length?(r(),k("div",It,[(r(!0),k(z,null,Q(e(n).masterUsers,v=>(r(),h(B,{db:v,key:v.id,onRefresh:i[5]||(i[5]=S=>e(n).getMasterUsers())},null,8,["db"]))),128))])):(r(),k("div",Ut,"No databases found"))])}}},At=E(St,[["__scopeId","data-v-3880af77"]]),Rt={class:"flex-row fc-space-between"},Tt=b("cancel"),Mt=b(" create "),jt={__name:"RestoreFromBackup",emits:["cancel","save"],setup(c,{emit:p}){let s=ee({}),n=V(!1);async function t(){p("cancel"),n.value=!1}async function l(){if(n.value)return!1;n.value=!0,await I("masterBackups.put",{body:s})&&N({type:"success",title:"Ecosystem is proccessing"}),p("save"),t()}return(m,o)=>{const i=K,$=O,x=ie;return r(),h(x,{title:"Create Database",onCancel:o[4]||(o[4]=y=>t())},{controls:u(()=>[a("div",Rt,[_($,{type:"basic",onClick:o[2]||(o[2]=y=>t())},{default:u(()=>[Tt]),_:1}),_($,{loading:e(n),onClick:o[3]||(o[3]=y=>l())},{default:u(()=>[Mt]),_:1},8,["loading"])])]),default:u(()=>[_(i,{label:"Name",modelValue:e(s).name,"onUpdate:modelValue":o[0]||(o[0]=y=>e(s).name=y)},null,8,["modelValue"]),_(i,{label:"License key",modelValue:e(s).license_key,"onUpdate:modelValue":o[1]||(o[1]=y=>e(s).license_key=y)},null,8,["modelValue"])]),_:1})}}},Et={class:"fm_card_subtitle"},Lt={class:"flex sb aic"},zt={key:1,class:"flex-row"},Nt=["href"],Ot=b(" REStore "),Yt={__name:"BackupsItem",props:{backup:Object},emits:["refresh"],setup(c,{emit:p}){const s=c;let n=V(!1),t=V(!1),l=re();async function m(){let o=await I("masterBackups.delete",{params:{id:s.backup.id}});console.log("res:",o),p("refresh")}return(o,i)=>{const $=q,x=O,y=jt,f=se;return r(),h(f,{title:c.backup.name,controls:""},{controls:u(()=>[a("div",Lt,[e(n)?g("",!0):(r(),h($,{key:0,icon:"lock",tooltip:"Show more",primary:"",onClick:i[0]||(i[0]=d=>F(n)?n.value=!0:n=!0)})),e(n)?(r(),k("div",zt,[a("a",{target:"download",class:"mr-10",href:`${e(l).public.apiURL}/authorizer/master-user-backups/${c.backup.id}/view/`},[_($,{icon:"cloud_download",tooltip:"Export backup",primary:"",class:""})],8,Nt),_($,{icon:"delete",primary:"",tooltip:"Delete backup",onClick:i[1]||(i[1]=d=>m())})])):g("",!0),_(x,{type:"basic",onClick:i[2]||(i[2]=d=>F(t)?t.value=!0:t=!0)},{default:u(()=>[Ot]),_:1})])]),default:u(()=>[a("div",Et,"File size: "+D(Math.round(c.backup.file_size/1024*100)/100)+" MB",1),_(y,{onCancel:i[3]||(i[3]=d=>F(t)?t.value=!1:t=!1),onSave:i[4]||(i[4]=d=>p("refresh")),modelValue:e(t),"onUpdate:modelValue":i[5]||(i[5]=d=>F(t)?t.value=d:t=d)},null,8,["modelValue"])]),_:1},8,["title"])}}},Ht=E(Yt,[["__scopeId","data-v-f60ca90e"]]),Wt={key:0,class:"fm_container backups"},qt={key:1,class:"text-h4"},Kt={__name:"Backups",async setup(c){let p,s,n=V(""),{data:t,refresh:l}=([p,s]=X(()=>oe("masterBackups",()=>I("masterBackups.get",{filters:{name:n.value}}),"$nri1BVdgko")),p=await p,s(),p);return(m,o)=>{const i=q,$=K,x=ke,y=Ht;return r(),k("div",null,[_(x,{onRefresh:o[1]||(o[1]=f=>e(l)())},{action:u(()=>[_($,{type:"text",modelValue:e(n),"onUpdate:modelValue":o[0]||(o[0]=f=>F(n)?n.value=f:n=f),placeholder:"Search",class:"bi_no_borders"},{button:u(()=>[_(i,{icon:"search"})]),_:1},8,["modelValue"])]),_:1}),e(t)&&e(t).results.length?(r(),k("div",Wt,[(r(!0),k(z,null,Q(e(t).results,f=>(r(),h(y,{backup:f,key:f.id,onRefresh:o[2]||(o[2]=d=>e(l)())},null,8,["backup"]))),128))])):(r(),k("div",qt,"No backups found"))])}}},Gt=E(Kt,[["__scopeId","data-v-26ef497d"]]),Qt=""+globalThis.__publicAssetsURL("img/g-auth-app.svg"),ue=""+globalThis.__publicAssetsURL("img/app-store.png"),de=""+globalThis.__publicAssetsURL("img/google-play.png"),Xt=""+globalThis.__publicAssetsURL("img/microsoft-authenticator.svg"),Y=c=>(ve("data-v-44bbf361"),c=c(),be(),c),Zt={key:0,class:"modal_container",style:{"margin-bottom":"15px"}},Jt=b(" An authenticator app lets you generate security codes on your mobile phone. "),es=Y(()=>a("br",null,null,-1)),ts=Y(()=>a("br",null,null,-1)),ss=b(" To configure your authenticator app: "),os=Y(()=>a("br",null,null,-1)),ns=Y(()=>a("br",null,null,-1)),as=Y(()=>a("ul",null,[a("li",null,"- Add a new time-based token"),a("li",null,"- Use your app to scan the QR code below")],-1)),ls={class:"flex jcc"},is={class:"flex jcc"},rs={key:0},cs=Y(()=>a("ul",null,[a("li",{class:"flex sb aic auth_app_item"},[a("div",null,[a("img",{width:"33",src:Qt,alt:""}),b(" Google authenticator ")]),a("div",{class:"flex center"},[a("a",{href:"https://apps.apple.com/us/app/google-authenticator/id388497605",target:"_blank"},[a("img",{width:"112",src:ue,alt:""})]),a("a",{href:"https://play.google.com/useStore/apps/details?id=com.google.android.apps.authenticator2",target:"_blank"},[a("img",{width:"112",src:de,alt:""})])])]),a("li",{class:"flex sb aic auth_app_item"},[a("div",null,[a("img",{width:"33",src:Xt,alt:""}),b(" Microsoft authenticator ")]),a("div",{class:"d-flex align-center"},[a("a",{href:"https://apps.apple.com/us/app/microsoft-authenticator/id983156458",target:"_blank"},[a("img",{width:"112",src:ue,alt:""})]),a("a",{href:"https://play.google.com/useStore/apps/details?id=com.azure.authenticator",target:"_blank"},[a("img",{width:"112",src:de,alt:""})])])])],-1)),_s=[cs],us={key:2,class:"modal_container"},ds=b(" Enter the security code generated by your authenticator app to make sure it's configured correctly "),ms=Y(()=>a("br",null,null,-1)),ps=Y(()=>a("br",null,null,-1)),fs={class:"flex sb"},vs=b("cancel"),bs=b("back"),ys=b("next"),ks=b("next"),$s=b("finish"),hs={__name:"TwoFAModal",emits:["close"],async setup(c,{emit:p}){let s,n,t=V("start"),l=V(!1),m=V(""),i=([s,n]=X(()=>I("generateQR.put")),s=await s,n(),s).provisioning_uri;async function $(){if(!m.value||m.value.length<6)return!1;let f=await I("validateQR.put",{body:{code:m.value,username:"test"}});f.match&&(console.log("res.match:",f.match),x(f.id))}async function x(f){await I("meTwoFactor.patch",{body:{is_active:!0},params:{id:f}})&&y()}async function y(f=!0){t.value="start",l.value=!1,m.value="",p("close",f)}return(f,d)=>{const M=G("vue-qrcode"),B=O,v=K,S=ie;return r(),h(S,{title:"Two-factor authentication"},{controls:u(()=>[a("div",fs,[e(t)!="finish"?(r(),h(B,{key:0,type:"text",onClick:d[3]||(d[3]=A=>y())},{default:u(()=>[vs]),_:1})):(r(),h(B,{key:1,type:"text",onClick:d[4]||(d[4]=A=>F(t)?t.value="scan":t="scan")},{default:u(()=>[bs]),_:1})),e(t)=="start"?(r(),h(B,{key:2,onClick:d[5]||(d[5]=A=>F(t)?t.value="scan":t="scan")},{default:u(()=>[ys]),_:1})):g("",!0),e(t)=="scan"?(r(),h(B,{key:3,onClick:d[6]||(d[6]=A=>F(t)?t.value="finish":t="finish")},{default:u(()=>[ks]),_:1})):g("",!0),e(t)=="finish"?(r(),h(B,{key:4,onClick:d[7]||(d[7]=A=>y(!1))},{default:u(()=>[$s]),_:1})):g("",!0)])]),default:u(()=>[e(t)=="start"?(r(),k("p",Zt," Two-factor authentication adds an extra layout of protection to your account. Whenever you sign in to the Finmars you will need to enter both your password and a security code on your mobile phone. ")):g("",!0),e(t)=="scan"?(r(),k(z,{key:1},[Jt,es,ts,ss,os,ns,as,a("div",ls,[_(M,{value:e(i),options:{width:236,border:0}},null,8,["value"])]),a("div",is,[_(B,{class:"mb-15",type:"action",onClick:d[0]||(d[0]=A=>F(l)?l.value=!e(l):l=!e(l))},{default:u(()=>[b(D(e(l)?"Hide":"Show")+" authenticator Apps ",1)]),_:1})]),e(l)?(r(),k("div",rs,_s)):g("",!0)],64)):g("",!0),e(t)=="finish"?(r(),k("div",us,[ds,ms,ps,_(v,{label:"Security code",modelValue:e(m),"onUpdate:modelValue":d[1]||(d[1]=A=>F(m)?m.value=A:m=A),onInput:d[2]||(d[2]=A=>$())},null,8,["modelValue"])])):g("",!0)]),_:1})}}},gs=E(hs,[["__scopeId","data-v-44bbf361"]]),ws={class:"fm_container databases"},xs={class:"flex jcfe"},Cs=b("save"),Vs={class:"flex jcfe"},Bs=b("save"),Ds={class:"flex jcfe"},Fs={__name:"Settings",async setup(c){let p,s,n=V(!1),t=ee({}),l=V(!1);const m=te();let o=m.user,i=V({}),{data:$,refresh:x}=([p,s]=X(()=>oe("2fa",()=>I("meTwoFactor.get"),"$qoAg7So2XA")),p=await p,s(),p);async function y(){let B=await I("meSetPassword.put",{body:t});t.password="",t.new_password="",t.new_password_check="",B.error?i.value=B.error:N({type:"success",title:"Saved"})}async function f(){let B=await I("me.put",{body:o});B.error?i.value=B.error:N({type:"success",title:"Saved"})}async function d(B){if(l.value=!1,!B)return!1;o.two_factor_verification=!0,await f(),await m.getUser(),o=m.user,x()}async function M(){var B;console.log("data:",$),await I("meTwoFactor.delete",{params:{id:(B=$.value.results[0])==null?void 0:B.id}}),o.two_factor_verification=!1,await f(),await m.getUser(),o=m.user,x()}return(B,v)=>{const S=K,A=Re,T=O,R=se,P=q,j=gs;return r(),k("div",ws,[_(R,{class:"settings_block",title:"Personal data",controls:""},{controls:u(()=>[a("div",xs,[_(T,{onClick:v[4]||(v[4]=C=>f())},{default:u(()=>[Cs]),_:1})])]),default:u(()=>[_(S,{label:"First name",modelValue:e(o).first_name,"onUpdate:modelValue":v[0]||(v[0]=C=>e(o).first_name=C),error:e(i).first_name},null,8,["modelValue","error"]),_(S,{label:"Last name",modelValue:e(o).last_name,"onUpdate:modelValue":v[1]||(v[1]=C=>e(o).last_name=C),error:e(i).last_name},null,8,["modelValue","error"]),_(S,{label:"E-mail",modelValue:e(o).email,"onUpdate:modelValue":v[2]||(v[2]=C=>e(o).email=C),error:e(i).email},null,8,["modelValue","error"]),_(A,{label:"Autosave mode",modelValue:e(o).data.autosave_layouts,"onUpdate:modelValue":v[3]||(v[3]=C=>e(o).data.autosave_layouts=C)},null,8,["modelValue"])]),_:1}),_(R,{class:"settings_block",title:"Password",controls:""},{controls:u(()=>[a("div",Vs,[_(T,{onClick:v[11]||(v[11]=C=>y())},{default:u(()=>[Bs]),_:1})])]),default:u(()=>[_(S,{label:"Old password",modelValue:e(o).password,"onUpdate:modelValue":v[6]||(v[6]=C=>e(o).password=C),type:e(n)?"text":"password",error:e(i).password},{button:u(()=>[_(P,{icon:e(n)?"visibility":"visibility_off",onClick:v[5]||(v[5]=C=>F(n)?n.value=!e(n):n=!e(n))},null,8,["icon"])]),_:1},8,["modelValue","type","error"]),_(S,{label:"New password",modelValue:e(o).new_password,"onUpdate:modelValue":v[8]||(v[8]=C=>e(o).new_password=C),type:e(n)?"text":"password",error:e(i).new_password},{button:u(()=>[_(P,{icon:e(n)?"visibility":"visibility_off",onClick:v[7]||(v[7]=C=>F(n)?n.value=!e(n):n=!e(n))},null,8,["icon"])]),_:1},8,["modelValue","type","error"]),_(S,{label:"New password (confirm)",modelValue:e(o).new_password_check,"onUpdate:modelValue":v[10]||(v[10]=C=>e(o).new_password_check=C),type:e(n)?"text":"password"},{button:u(()=>[_(P,{icon:e(n)?"visibility":"visibility_off",onClick:v[9]||(v[9]=C=>F(n)?n.value=!e(n):n=!e(n))},null,8,["icon"])]),_:1},8,["modelValue","type"])]),_:1}),_(R,{class:"settings_block",title:"Two-factor authentication"},{controls:u(()=>[a("div",Ds,[_(T,{onClick:v[12]||(v[12]=C=>e(o).two_factor_verification?M():F(l)?l.value=!0:l=!0)},{default:u(()=>[b(D(e(o).two_factor_verification?"Remove device":"Add device"),1)]),_:1})]),_(j,{modelValue:e(l),"onUpdate:modelValue":v[13]||(v[13]=C=>F(l)?l.value=C:l=C),onClose:v[14]||(v[14]=C=>d(C))},null,8,["modelValue"])]),default:u(()=>[a("div",null,D(e(o).two_factor_verification?"Device connected":"No connected devices"),1)]),_:1})])}}},Ps=E(Fs,[["__scopeId","data-v-6dac507f"]]),H=c=>(ve("data-v-23eb4432"),c=c(),be(),c),Is={class:"fm_container"},Us={class:"flex aic"},Ss=H(()=>a("h3",{class:"text-h4"},"Active Tokens",-1)),As=b("Logout from all devices"),Rs={key:0,class:"token_item_line"},Ts=H(()=>a("b",{class:"token_item_title"},"Workspace:",-1)),Ms={key:0,class:"current_token"},js={class:"token_item_line"},Es=H(()=>a("b",{class:"token_item_title"},"Access Expire at:",-1)),Ls={class:"token_item_line"},zs=H(()=>a("b",{class:"token_item_title"},"Refresh Expire at:",-1)),Ns={class:"token_item_line"},Os=H(()=>a("b",{class:"token_item_title"},"Created:",-1)),Ys={key:1,class:"flex token_item_line"},Hs=H(()=>a("b",{class:"token_item_title"},"API URL: ",-1)),Ws={class:"token_item_line"},qs=H(()=>a("b",{class:"token_item_title"},"Access Token: ",-1)),Ks={style:{"max-width":"600px"}},Gs={class:"token_item_line"},Qs=H(()=>a("b",{class:"token_item_title"},"Refresh Token: ",-1)),Xs={style:{"max-width":"600px"}},Zs={class:"token_item_line"},Js=b(" Refresh token "),eo=b("Delete token"),to={__name:"Api",async setup(c){let p,s,n=([p,s]=X(()=>I("tokenInfo.get")),p=await p,s(),p).results,t=V([]),l=te();const m=re();function o(i){return ae(i).format("DD.MM.YYYY LT")}return(i,$)=>{const x=O,y=fe;return r(),k("div",Is,[a("div",Us,[Ss,_(x,{type:"text",class:"m-l-8"},{default:u(()=>[As]),_:1})]),(r(!0),k(z,null,Q(e(n),(f,d)=>(r(),k("ul",{class:"token_item",key:d},[f.current_master_user_object?(r(),k("li",Rs,[Ts,b(" "+D(f.current_master_user_object.name)+" ",1),f.current_master_user_object&&e(l).current.base_api_url==f.current_master_user_object.base_api_url?(r(),k("div",Ms," Current ")):g("",!0)])):g("",!0),a("li",js,[Es,b(" "+D(o(f.access_token_expires_at)),1)]),a("li",Ls,[zs,b(" "+D(o(f.refresh_token_expires_at)),1)]),a("li",Ns,[Os,b(" "+D(o(f.created)),1)]),f.current_master_user_object?(r(),k("li",Ys,[Hs,_(y,{to:`${e(m).public.apiURL}/${f.current_master_user_object.base_api_url}/api/v1`},{default:u(()=>[b(D(`${e(m).public.apiURL}/${f.current_master_user_object.base_api_url}/api/v1`),1)]),_:2},1032,["to"])])):g("",!0),le(a("li",Ws,[qs,a("div",Ks,D(f.keycloak_access_token),1)],512),[[_e,e(t)[d]]]),le(a("li",Gs,[Qs,a("div",Xs,D(f.keycloak_refresh_token),1)],512),[[_e,e(t)[d]]]),a("li",Zs,[_(x,{onClick:M=>e(t)[d]=!e(t)[d],class:"m-r-4"},{default:u(()=>[b(D(e(t)[d]?"Hide":"Show")+" tokens ",1)]),_:2},1032,["onClick"]),f.current_master_user_object&&e(l).current.base_api_url==f.current_master_user_object.base_api_url?(r(),h(x,{key:0,class:"m-r-4"},{default:u(()=>[Js]),_:1})):g("",!0),_(x,{type:"basic",class:"m-r-4"},{default:u(()=>[eo]),_:1})])]))),128))])}}},so=E(to,[["__scopeId","data-v-23eb4432"]]),oo=b("Profile"),no={__name:"index",setup(c){const p=["Workspaces","Backups","Billing","Settings","Api"];let s=V("Workspaces");return V(null),(n,t)=>{const l=G("Title"),m=G("Link"),o=G("Head"),i=ze,$=At,x=Gt,y=Se,f=Ps,d=so;return r(),k("div",null,[_(o,null,{default:u(()=>[_(l,null,{default:u(()=>[oo]),_:1}),_(m,{type:"image/x-icon",rel:"icon",href:"/img/favicon/favicon.ico"})]),_:1}),_(i,{modelValue:e(s),"onUpdate:modelValue":t[0]||(t[0]=M=>F(s)?s.value=M:s=M),tabs:p},null,8,["modelValue"]),e(s)=="Workspaces"?(r(),h($,{key:0})):g("",!0),e(s)=="Backups"?(r(),h(x,{key:1})):g("",!0),e(s)=="Billing"?(r(),h(y,{key:2})):g("",!0),e(s)=="Settings"?(r(),h(f,{key:3})):g("",!0),e(s)=="Api"?(r(),h(d,{key:4})):g("",!0)])}}},vo=Object.freeze(Object.defineProperty({__proto__:null,default:no},Symbol.toStringTag,{value:"Module"}));export{vo as i,fo as u};
