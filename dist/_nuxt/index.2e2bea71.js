import{_ as A}from"./Icon.02350196.js";import{_ as E}from"./Input.5f2d228f.js";import{_ as O}from"./TopRefresh.9a62cc06.js";import{_ as z}from"./Date.1e44e27d.js";import{a as B,b as F,r as g,o as r,f as u,h as e,t as c,i as J,u as m,j as L,k as l,w as n,F as C,y as P,l as W,T as G,m as x,p as H,z as N,W as K,q as T,s as U,Y as V,v as Q,x as h,c as D}from"./entry.e001551d.js";import{_ as X}from"./Card.b3aab90e.js";import{u as S}from"./useNotify.ee45f36b.js";import"./HorizontalPanel.b65b1a2f.js";const y=s=>(T("data-v-ce451001"),s=s(),U(),s),Z={class:""},ee={class:"table-cell"},te={class:"table-cell"},se={class:"table-cell"},oe={key:0},ae={class:"sp_item d-flex"},le=y(()=>e("b",{class:"sp_item_h"},"Procedure",-1)),ne={class:"sp_item d-flex"},ce=y(()=>e("b",{class:"sp_item_h"},"Provider",-1)),ie={class:"sp_item d-flex"},_e=y(()=>e("b",{class:"sp_item_h"},"Action",-1)),de={class:"sp_item d-flex"},re=y(()=>e("b",{class:"sp_item_h"},"Info",-1)),ue={class:"sp_item d-flex"},me=y(()=>e("b",{class:"sp_item_h"},"Status",-1)),pe={class:"center"},fe=x(" Show request "),ve={class:"flex sb"},he=x("cancel"),ge=x("copy"),xe=x("ok"),$e={__name:"item",props:["item"],setup(s){F(),g(null);let o=g(!1);g(!1);const p={P:"Processing",D:"Done",I:"Init",E:"Error"};function b(d){navigator.clipboard.writeText(d),S({type:"success",title:"Copied successfully"})}function $(d){return H(d).format("DD.MM.YYYY LT")}return(d,f)=>{const v=N,i=K;return r(),u("div",Z,[e("div",{class:J(["table-row",{active:m(o)}]),onClick:f[0]||(f[0]=t=>L(o)?o.value=!m(o):o=!m(o))},[e("div",ee,c(s.item.procedure_object.name.length>30?s.item.procedure_object.name.slice(0,25)+"...":s.item.procedure_object.name),1),e("div",te,c($(s.item.created)),1),e("div",se,c(Math.floor(s.item.procedures.filter(t=>t.status=="D").length/s.item.procedures.length*100))+"%",1)],2),l(G,null,{default:n(()=>[m(o)?(r(),u("div",oe,[(r(!0),u(C,null,P(s.item.procedures,t=>(r(),u("div",{class:"sub_procedure",key:t.id},[e("div",ae,[le,e("div",null,c(t.procedure_object.name),1)]),e("div",ne,[ce,e("div",null,c(t.provider_verbose),1)]),e("div",ie,[_e,e("div",null,c(t.action_verbose),1)]),e("div",de,[re,e("div",null,c(t.successful_prices_count)+" successful, "+c(t.error_prices_count)+" errors",1)]),e("div",ue,[me,e("div",null,c(p[t.status]),1)]),e("div",pe,[l(v,{type:"action",onClick:_=>t.dialog=!0},{default:n(()=>[fe]),_:2},1032,["onClick"]),l(i,{modelValue:t.dialog,"onUpdate:modelValue":_=>t.dialog=_,onCancel:_=>t.dialog=!1,title:"Procedure request"},{controls:n(()=>[e("div",ve,[l(v,{type:"action",onClick:_=>t.dialog=!1},{default:n(()=>[he]),_:2},1032,["onClick"]),e("div",null,[l(v,{class:"m-r-4",type:"text",onClick:_=>b(JSON.stringify(t.request_data,null,2))},{default:n(()=>[ge]),_:2},1032,["onClick"]),l(v,{onClick:_=>t.dialog=!1},{default:n(()=>[xe]),_:2},1032,["onClick"])])])]),default:n(()=>[e("pre",null,c(JSON.stringify(t.request_data,null,2)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onCancel"])])]))),128))])):W("",!0)]),_:1})])}}},ye=B($e,[["__scopeId","data-v-ce451001"]]);const j=s=>(T("data-v-35605d99"),s=s(),U(),s),be={class:"flex aifs"},ke={class:"fm_container cards"},Ce={class:"fm_card_content"},Pe=j(()=>e("div",null," Date range ",-1)),Se={class:"flex sb p-t-16"},we={class:"date_item"},Ie={class:"date_item"},Ve={class:"flex sb"},De=x("edit"),Be=x("execute"),Fe={class:"table"},Ne=j(()=>e("div",{class:"table-row header"},[e("div",{class:"table-cell"},"Procedure"),e("div",{class:"table-cell"},"Date"),e("div",{class:"table-cell"},"Status")],-1)),Te={__name:"index",async setup(s){let o,p;const b=F();let $=g(null),d=g(null),f=g(!1);if(b.current.base_api_url){let i=([o,p]=V(()=>h("pricingProc.get")),o=await o,p(),o);$.value=i.results;let t=([o,p]=V(()=>h("pricingProcInstance.get")),o=await o,p(),o);d.value=t.results}async function v(i){if(f.value=!0,S({title:"Procedure is processing"}),await h("pricingProc.post",{body:i,params:{id:i.id}})){f.value=!1,S({type:"success",title:"Success. Procedure is being processed"});let _=await h("pricingProcInstance.get");d.value=_.results}}return Q(()=>b.current,async()=>{let i=await h("pricingProc.get");$.value=i.results;let t=await h("pricingProcInstance.get");d.value=t.results}),(i,t)=>{const _=A,q=E,Y=O,w=z,I=N,M=X,R=ye;return r(),u("div",null,[l(Y,{onRefresh:t[0]||(t[0]=a=>i.refresh())},{action:n(()=>[l(q,{type:"text",placeholder:"Search",class:"bi_no_borders"},{button:n(()=>[l(_,{icon:"search"})]),_:1})]),_:1}),e("div",be,[e("div",ke,[(r(!0),u(C,null,P(m($),a=>(r(),D(M,{key:a.id,title:a.user_code,controls:""},{controls:n(()=>[e("div",Ve,[l(I,{type:"action",to:`/valuations/run-pricing/${a.id}`},{default:n(()=>[De]),_:2},1032,["to"]),l(I,{disabled:m(f),onClick:k=>v(a)},{default:n(()=>[Be]),_:2},1032,["disabled","onClick"])])]),default:n(()=>[e("div",Ce,c(a.notes),1),Pe,e("div",Se,[e("div",we,[l(w,{class:"m-b-0",label:"Date from",modelValue:a.price_date_from_calculated,"onUpdate:modelValue":k=>a.price_date_from_calculated=k},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Ie,[l(w,{class:"m-b-0",label:"Date to",modelValue:a.price_date_to_calculated,"onUpdate:modelValue":k=>a.price_date_to_calculated=k},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1032,["title"]))),128))]),e("div",Fe,[Ne,(r(!0),u(C,null,P(m(d),a=>(r(),D(R,{key:a.id,item:a},null,8,["item"]))),128))])])])}}},Oe=B(Te,[["__scopeId","data-v-35605d99"]]);export{Oe as default};
