<md-dialog aria-label="dashboard report viewer component settings dialog"
           class="draggable-dialog width-50"
           drag-dialog>
    <md-toolbar>
        <div class="md-toolbar-tools">
            <h2>Chart Component Editor</h2>
            <span flex></span>
        </div>
    </md-toolbar>

    <md-dialog-content>

        <md-tabs md-dynamic-height>

            <md-tab label="MAIN">
                <md-content class="p-16">

                    <div class="dashboard-constructor-field2" style="margin: 0 10px;">
                        <md-input-container class="m-0 width-100">
                            <label>Chart Label</label>
                            <input type="text" data-ng-model="vm.item.chart_custom_name">
                        </md-input-container>
                    </div>

                    <div data-ng-if="vm.chartType === 'report_viewer_bars_chart' && vm.availableAttrs && vm.availableAttrs.length"
                         class="dashboard-constructor-field1"
                         style="margin: 0 10px 24px;">

                        <md-input-container class="m-0 width-100"
                                            aria-label="select with filter">
                            <label>Category</label>
                            <md-select ng-model="vm.item.settings.bar_name_key"
                                       md-container-class="common-select-container"
                                       md-on-close="vm.categoriesSearchTerm = ''">

                                <md-select-header>
                                    <input data-ng-model="vm.categoriesSearchTerm"
                                           type="search"
                                           placeholder="Search for a ..."
                                           class="md-text md-select-search-pattern select-input-filter"
                                           ng-keydown="$event.stopPropagation()">
                                </md-select-header>

                                <div class="select-options-holder">

                                    <md-option
                                            data-ng-repeat="attr in vm.availableAttrs | orderBy: 'order' | filter:vm.categoriesFilterExpr"
                                            ng-value="attr.attribute_data.key"
                                            ng-bind="vm.getSelectName(attr)">
                                    </md-option>

                                </div>

                            </md-select>
                        </md-input-container>

                    </div>

                    <div data-ng-if="vm.chartType === 'report_viewer_pie_chart' && vm.availableAttrs && vm.availableAttrs.length"
                         class="dashboard-constructor-field1"
                         style="margin: 0 10px 24px;">

                        <md-input-container class="m-0 width-100"
                                            aria-label="select with filter">
                            <label>Category</label>
                            <md-select ng-model="vm.item.settings.group_attr"
                                       md-container-class="common-select-container"
                                       md-on-close="vm.categoriesSearchTerm = ''">

                                <md-select-header>
                                    <input data-ng-model="vm.categoriesSearchTerm"
                                           type="search"
                                           placeholder="Search for a ..."
                                           class="md-text md-select-search-pattern select-input-filter"
                                           ng-keydown="$event.stopPropagation()">
                                </md-select-header>

                                <div class="select-options-holder">

                                    <md-option
                                            data-ng-repeat="attr in vm.availableAttrs | orderBy: 'order' | filter:vm.categoriesFilterExpr"
                                            ng-value="attr.attribute_data.key"
                                            ng-bind="vm.getSelectName(attr)">
                                    </md-option>

                                </div>

                            </md-select>
                        </md-input-container>

                    </div>


                    <div class="m-b-24" layout="row">

                        <div data-ng-if="vm.chartType === 'report_viewer_bars_chart'"
                             class="dashboard-constructor-field1"
                             style="margin: 0 10px;">

                            <md-input-container data-ng-if="vm.availableNumericAttrs && vm.availableNumericAttrs.length > 0"
                                                class="m-0 width-100"
                                                aria-label="select with filter">
                                <label>Value</label>
                                <md-select ng-model="vm.item.settings.bar_number_key"
                                           md-container-class="common-select-container"
                                           md-on-close="vm.valuesSearchTerm = ''">

                                    <md-select-header>
                                        <input data-ng-model="vm.valuesSearchTerm"
                                               type="search"
                                               placeholder="Search for a ..."
                                               class="md-text md-select-search-pattern select-input-filter"
                                               ng-keydown="$event.stopPropagation()">
                                    </md-select-header>

                                    <div class="select-options-holder">

                                        <md-option
                                                data-ng-repeat="attr in vm.availableNumericAttrs | orderBy: 'order' | filter:vm.valuesFilterExpr"
                                                ng-value="attr.attribute_data.key"
                                                ng-bind="vm.getSelectName(attr)">
                                        </md-option>

                                    </div>

                                </md-select>
                            </md-input-container>

                        </div>

                        <div data-ng-if="vm.chartType === 'report_viewer_pie_chart' && vm.availableNumericAttrs && vm.availableNumericAttrs.length"
                             class="dashboard-constructor-field1"
                             style="margin: 0 10px;">

                            <md-input-container class="m-0 width-100"
                                                aria-label="select with filter">
                                <label>Value</label>
                                <md-select ng-model="vm.item.settings.number_attr"
                                           md-container-class="common-select-container"
                                           md-on-close="vm.valuesSearchTerm = ''">

                                    <md-select-header>
                                        <input data-ng-model="vm.valuesSearchTerm"
                                               type="search"
                                               placeholder="Search for a ..."
                                               class="md-text md-select-search-pattern select-input-filter"
                                               ng-keydown="$event.stopPropagation()">
                                    </md-select-header>

                                    <div class="select-options-holder">

                                        <md-option
                                                data-ng-repeat="attr in vm.availableNumericAttrs | orderBy: 'order' | filter:vm.valuesFilterExpr"
                                                ng-value="attr.attribute_data.key"
                                                ng-bind="vm.getSelectName(attr)">
                                        </md-option>

                                    </div>

                                </md-select>
                            </md-input-container>

                        </div>

                        <div>
                            <number-format-menu data-format-settings="vm.item.settings.number_format"
                                                data-button-content="<span>Number Format</span>"
                                                data-button-classes="md-raised md-primary"
                                                class="dashboard-constructor-btn-among-fields"></number-format-menu>
                        </div>

                        <md-input-container class="dashboard-constructor-field1"
                                            style="margin: 0 10px;">
                            <label for="">Calculation</label>
                            <md-select data-ng-model="vm.item.settings.group_number_calc_formula">
                                <md-option value="1">Sum</md-option>
                                <md-option value="2">Weighted Market Value</md-option>
                                <md-option value="3">Weighted Market Value Percent</md-option>
                                <md-option value="4">Weighted Exposure</md-option>
                                <md-option value="5">Weighted Exposure Percent</md-option>
                                <md-option value="6">Weighted Average Market Value</md-option>
                                <md-option value="7">Weighted Average Market Value Percent</md-option>
                                <md-option value="8">Weighted Average Exposure</md-option>
                                <md-option value="9">Weighted Average Exposure Percent</md-option>
                            </md-select>
                        </md-input-container>

                    </div>

                </md-content>
            </md-tab>

            <!-- COMMITTED: 07.07.2020 -->
            <!--<md-tab label="LINKING">
                <md-content class="p-16">

                    <h4>Linked to</h4>

                    <div class="dashboard-linked-filters-container">
                        <ui>
                            <li data-ng-repeat="compName in vm.linkedToComps">
                                <span data-ng-bind="compName"></span>
                            </li>
                        </ui>
                    </div>

                    <h4>Linked by</h4>

                    <div class="dashboard-linked-filters-container">
                        <ui>
                            <li data-ng-repeat="compName in vm.linkedByComps">
                                <span data-ng-bind="compName"></span>
                            </li>
                        </ui>
                    </div>

                </md-content>
            </md-tab>-->
            <!-- < COMMITTED: 07.07.2020 > -->

        </md-tabs>

    </md-dialog-content>

    <md-dialog-actions layout="row" layout-align="space-between center">
        <div>
            <md-button ng-click="vm.cancel()" style="margin-right:20px;">
                Cancel
            </md-button>
            <md-button ng-click="vm.agree('apply')" style="margin-right:20px;">
                Apply
            </md-button>
        </div>

        <div>
            <md-button ng-click="vm.agree('save')" style="margin-right:20px;">
                Save and Apply
            </md-button>
        </div>
    </md-dialog-actions>
</md-dialog>